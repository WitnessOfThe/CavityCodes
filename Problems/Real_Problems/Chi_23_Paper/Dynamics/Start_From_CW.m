% Res.Stat           = Res.Stat(1);
% Res.Stat.In        = Res.Temp.In;
% Res.Stat.Sol.Psi_o = Res.Temp.Sol.Psio(end-1,:);
% Res.Stat.Sol.Psi_e = Res.Temp.Sol.Psie(end-1,:);
% Res.Stat.Sol.V     = 0;
% Res.Stat.Stab      = [];
% Res.Stat.Logic     = [];
%%
% $x^2+e^{\pi i}$

%%
    clear all;

%%
    Res = Set_Up_Methods_For_Chi23_Paper;
    
%%
    
    Res.CW.In         = Params_JuanjuanLiNbd;
    Res.CW.In.eps     = -Res.CW.In.ko*50;%-Res.CW.In.ko*10;
    Res.CW.In.delta_o = Res.CW.In.ko*9.5;
    Res.CW.In.N       = 2^8;
    Res.CW.In.W       = 2E5*Res.CW.In.W_Star;
    Res.CW.In.mu_bl   = 1;
    
%%
    Res.CW.Par.Equation_string  = 'Chi23_CW';
    Res.CW.Met.Equation         = @Chi23_CW;
    Res.CW.Met.InitialGuess     = @Chi_3_Stat_In_Guess_Chi_3_LLE_From_CW;    
    Res.CW.Met.Newton           = @fsolve;%'fsolve'
    Res.CW.Par.Change_Space     = 0;
    
    Res.CW.Par.variable         = 'delta_o';  %%'Pump Power';
    Res.CW.Par.first_step       = 0.05; % step for delta measured in delta/kappa
    Res.CW.Par.step_tol         = 0.001;
    Res.CW.Par.step_inc         = 0.00;
    Res.CW.Par.step_dec         = 0.5;

    Res.CW.Par.bot_boundary     = -40; % bottom boundary for delta to search
    Res.CW.Par.top_boundary     =  40; % top boundary for delta to search
    Res.CW.Par.Sol_Re_Sign      = '-';
    Res.CW.Par.Stability        = false;
    Res.CW.Par.Newton_iter      = 30;      
    Res.CW.Par.Newton_tol       = 1E-10;  
    Res.CW.Par.i_max            = 1000;
    
    Res.CW.Par.fsolveoptions     = optimoptions('fsolve','CheckGradients',...
    false,'Display','none','UseParallel',false,'SpecifyObjectiveGradient',false,...
    'Algorithm','trust-region-dogleg','FunValCheck','on',...
    'MaxIterations',1000,'StepTolerance',1E-25,'OptimalityTolerance',1E-25,'FunctionTolerance',10^(-15));

    

  %%
    
    Res.Temp.Par.Runge_Type    = 'Runge SSPRK3';    
    Res.Temp.Par.dt            = 1E-5;
    Res.Temp.Par.s_t           = 0.01;
    Res.Temp.Par.T             = 100;
    
    Res.Temp.Par.dd            = Res.Temp.Par.T/Res.Temp.Par.s_t;
    Res.Temp.Par.CW_num        = 1;
    Runge                      = Define_Runge_Coeff(Res.Temp.Par);
    
 %%
    delta_vector      = linspace(-17.8,16,6);
    delta_stary       = -15*ones(1,length(delta_vector));
    NN = length(delta_vector);
    Power_vector      = ones(1,NN)*Res.CW.In.W/Res.CW.In.W_Star;
    
   parfor i =1:length(delta_vector)
        ResSave(i) = Res;
        W                 = [Res.CW.In.W/Res.CW.In.W_Star,Power_vector(i)];
        delta             = [delta_stary(i),delta_vector(i)];
     
        [ResSave(i).CW, UU] = Chi23_CW_TrackToPoint(Res.CW,W,delta,1E3);
         ResSave(i).CW.Stab       = Chi23_MI(ResSave(i).CW);
        U(i) = ResSave(i).CW.Sol.Psi_o
        ResSave(i).Temp.In        = ResSave(i).CW.In;
        ResSave(i).Temp.In.N     = 2^6;
        ResSave(i).Temp          = ResSave(i).Temp.Met.Norm(ResSave(i).Temp);   
        ResSave(i).Temp          = Chi23_Temp_Start_CW(ResSave(i).Temp,ResSave(i).CW);
        
% end
%    Res.Temp.In.Psi_Start                 = 1E-4*ones(1,Res.Temp.Space.N*2);
%    Res.Temp.In.Psi_Start(1:Res.Temp.Space.N)                    = [0.00302010409680864 + 0.486048813059247i,-4.07555386129881e-17 - 1.09001379347766e-17i,-3.87413819357845e-17 - 4.83150306409474e-18i,-1.72292438854158e-17 - 3.06045959826176e-17i,-1.12885088928104e-17 - 2.75713146377533e-17i,1.28093264466550e-17 - 1.93873453864778e-17i,-8.16529697828086e-18 - 1.13119966415197e-17i,4.52256409387225e-18 + 3.36832984442744e-18i,-1.16768048492402e-19 + 4.23535178309106e-19i,-6.30128878123011e-19 - 5.68684439104944e-19i,3.76694823650009e-05 - 0.000896725015706634i,-8.87635033036882e-19 + 1.47823138875416e-19i,1.11106637472249e-18 - 1.93052895861506e-19i,-4.13364600311932e-18 + 4.39105289003391e-18i,-7.58541448617290e-18 - 1.50430883545845e-17i,-2.03573299511857e-17 + 1.39814171897601e-17i,-2.21448987227477e-17 - 2.16478876242099e-17i,-3.20946602876804e-17 - 1.55734358633217e-17i,-3.09812874752802e-17 + 2.43195942569910e-17i,-1.07204386779588e-17 - 4.07413808546868e-17i,3.48002535952696e-06 - 6.19903480986533e-07i,9.20664460522027e-20 + 4.63681612486362e-17i,3.39022581021726e-17 - 3.24532227544666e-17i,4.30566429059154e-17 - 2.27349589945281e-17i,-4.76947417509431e-17 + 1.28521197574989e-17i,-4.82228851857710e-17 - 1.30969370076525e-17i,6.45311916772009e-18 + 5.01939724891115e-17i,-4.91086900552115e-17 - 1.44991079073210e-17i,-5.02788855807510e-17 - 7.88636678946310e-18i,2.10399368430125e-17 + 4.70736205427805e-17i,-1.79314562819126e-10 + 4.18217620390212e-10i,-4.07042481648773e-17 - 3.18334511637192e-17i,-4.18717108675980e-17 + 3.19325676800631e-17i,4.59918847254354e-17 - 2.51541003280396e-17i,2.10330297846362e-17 + 4.88993479808112e-17i,1.72384766684648e-17 + 4.98920248610657e-17i,5.17288836473881e-17 - 1.29135081289829e-17i,-5.30659460185838e-17 + 4.97329938729809e-18i,6.12713347323612e-18 - 5.30761915198354e-17i,2.12426209026443e-17 - 4.96652940570339e-17i,-2.05666835557939e-13 - 5.53484125258566e-13i,1.05907204131064e-17 + 5.35479909948182e-17i,-4.81270991725694e-17 - 2.54430081274407e-17i,-1.25273132878666e-17 - 5.34242597979800e-17i,-3.83094310889120e-17 - 3.84044915295844e-17i,-2.17693530777670e-17 + 4.98810466899145e-17i,1.24644066356274e-17 - 5.38929023326019e-17i,5.38363081272240e-17 + 1.26154910543765e-17i,4.98642609297975e-17 + 2.41496645703414e-17i,4.21765153213518e-17 - 3.61485609334268e-17i,4.34365098355315e-16 - 2.03940897584769e-16i,3.92557729387283e-17 - 3.89672233344059e-17i,5.29988040161957e-17 + 1.64505557253117e-17i,5.59034866309581e-17 + 1.72197176035593e-18i,4.41421986464711e-19 - 5.57569056704472e-17i,-1.18325384006754e-17 + 5.48838207704013e-17i,-4.40365998507589e-17 - 3.49792636721314e-17i,-1.16401140256327e-17 - 5.51991442785691e-17i,-4.26311801046290e-17 - 3.73136212437013e-17i,-1.85491270769084e-17 + 5.33872459161634e-17i,1.11855606610552e-17 - 5.57973656288056e-17i,5.39425932299776e-17 + 1.78517871734118e-17i,4.40354310240718e-17 + 3.62561210488546e-17i,5.58076736720694e-17 - 1.43144717744386e-17i,-4.62525959929384e-17 - 3.52066374820492e-17i,5.63977702109399e-17 + 1.21374889961043e-17i,-2.46837939681371e-18 + 5.80352109271970e-17i,-8.28382352558883e-18 + 5.75839223765234e-17i,5.10461302342870e-17 + 2.77554204651860e-17i,-2.51570846230049e-17 - 5.25461165728448e-17i,5.29429042933624e-17 + 2.54162784018318e-17i,-1.88286370236571e-18 + 5.87130395157626e-17i,6.52443222340222e-18 + 5.86963344115659e-17i,5.88968231174978e-17 + 7.49925201194816e-19i,-5.42884958301688e-17 - 2.33468109919641e-17i,5.23149750417819e-17 - 2.85525265004828e-17i,5.42106951520508e-17 + 2.49729577687376e-17i,5.97923429082173e-17 + 4.26822933508916e-18i,-1.50131631186794e-18 - 5.98967787641356e-17i,-9.31011616289723e-18 + 5.94603387229501e-17i,-4.93083695933557e-17 - 3.48858145626987e-17i,-1.36859365361246e-17 - 5.91124456946794e-17i,-4.32698270312066e-17 - 4.24319616954627e-17i,-2.83597236378122e-17 + 5.41364839461301e-17i,2.75764261349010e-17 - 5.46720141555631e-17i,4.61302782766762e-17 + 4.04326637108780e-17i,1.90267497426995e-17 + 5.84845750631437e-17i,5.44426341089712e-17 + 2.97058393691214e-17i,9.98014053900315e-19 - 6.19600221356196e-17i,1.16131586079123e-17 + 6.12929255389660e-17i,-6.19328534951637e-17 + 6.83007547915194e-18i,-6.07492802632953e-17 - 1.50792761755699e-17i,-4.81449595503223e-17 + 4.06298970197520e-17i,6.16109905536611e-17 + 1.31991697651334e-17i,-6.24790878612540e-17 + 1.08784119233270e-17i,-1.70313554299249e-17 - 6.12626092342196e-17i,-6.11633010542549e-18 - 6.35575177271003e-17i,-6.01125501024121e-17 - 2.25633163329894e-17i,2.93947423730147e-17 + 5.72487209179829e-17i,-5.54119297144123e-17 - 3.35235950120730e-17i,1.73224454322698e-17 - 6.24918812373851e-17i,1.78867496635384e-17 - 6.26352152461990e-17i,-5.51916297414658e-17 - 3.53266821497235e-17i,2.76013616708614e-17 + 5.97353759904462e-17i,-6.02334102034031e-17 - 2.69078178147878e-17i,-1.32395185464292e-18 - 6.63789356577443e-17i,-1.15719985642582e-17 - 6.56125056718792e-17i,-6.66413157838637e-17 + 3.59418755425689e-18i,6.28770175291743e-17 + 2.32219837179465e-17i,-5.83460909649323e-17 + 3.39870198663838e-17i,-6.11518739252144e-17 - 2.89846666455875e-17i,-6.75888761308270e-17 - 8.53545314606040e-18i,-6.46448866887482e-18 + 6.80155296944644e-17i,2.29176275958101e-17 - 6.45576828029822e-17i,4.45110439789030e-17 + 5.26838532681763e-17i,-7.79258124978054e-18 + 6.87023078529748e-17i,2.47228491033009e-17 + 6.50357105810994e-17i,5.94545934508730e-17 - 3.65738182729253e-17i,-6.28550924890361e-17 + 3.11817584917907e-17i,-6.23279042720068e-18 - 7.03397799398597e-17i,3.82632780987052e-17 - 5.96759620159759e-17i,-4.22965045518092e-18 - 7.12331253433208e-17i,-6.57489280019278e-17 + 2.81342047374982e-17i,6.41382416723724e-17 - 3.23799422955138e-17i,1.75076259046768e-17 + 7.02100855604982e-17i,-1.86807203679587e-17 + 7.03462137044976e-17i,3.63679322747035e-17 + 6.33013148228715e-17i,3.84462847374653e-17 - 6.26264051101467e-17i,-6.54045689781532e-17 - 4.86252475826604e-17i,3.58885929147950e-17 + 7.25602062850647e-17i,-7.65055141455049e-17 - 2.47423246214481e-17i,-1.59061539522772e-17 - 7.84751606264907e-17i,-3.26520016521681e-17 - 7.26196776214748e-17i,-7.40155980706969e-17 + 2.78732900535453e-17i,7.85608674287206e-17 - 4.64123487251819e-19i,-4.65072204673933e-17 + 6.30650105441889e-17i,-7.78119268084413e-17 + 4.34125104645029e-19i,-7.25507352767832e-17 + 2.71423512194950e-17i,3.14075916720216e-17 + 7.03522357858115e-17i,-1.48222121845630e-17 - 7.50883440712502e-17i,7.24263410713139e-17 + 2.36814281113619e-17i,3.30249567537294e-17 + 6.81199105512376e-17i,6.05809690461356e-17 + 4.49542664525567e-17i,3.25764986288183e-17 - 6.75187075332844e-17i,-3.88362916758701e-17 + 6.36283495486142e-17i,-4.43905181648287e-17 - 5.96071653269649e-17i,2.63061624938526e-18 - 7.38010269871580e-17i,-3.97637926784706e-17 - 6.19898686395945e-17i,-4.61475807184664e-17 + 5.66879357449115e-17i,4.43078087836134e-17 - 5.77314382906944e-17i,4.40849376813696e-17 + 5.76355663590944e-17i,7.45736298229237e-18 + 7.18360548491947e-17i,5.31095071091180e-17 + 4.82169592733419e-17i,2.07343233149850e-17 - 6.84742330206709e-17i,-1.00985050115491e-17 + 7.03953933893421e-17i,-6.80151012585263e-17 - 1.93022412296996e-17i,-5.35989254702540e-17 - 4.54644726328685e-17i,-6.94039954089189e-17 + 1.05426625137486e-17i,4.57615849574985e-17 + 5.25633567598594e-17i,-5.81666027319333e-17 - 3.80924458590052e-17i,3.91424625805059e-17 - 5.69418672751620e-17i,5.39392648622597e-17 - 4.24308476196838e-17i,-5.08821496938689e-18 - 6.82717026409118e-17i,-4.93530421227792e-17 + 4.67242914682913e-17i,2.75561858597738e-17 - 6.19870534040550e-17i,6.39423831422372e-17 + 2.17793017101535e-17i,5.91558382397380e-17 + 3.21368701596042e-17i,5.55456172129903e-17 - 3.77312718752550e-17i,-6.58012705409012e-17 - 1.13792197619678e-17i,6.28325501651008e-17 - 2.20794451071018e-17i,3.50709942931318e-17 + 5.60249463740970e-17i,3.09729212797297e-17 + 5.82172970580746e-17i,6.52487399963228e-17 - 8.04919742148992e-18i,-5.65271814057688e-17 - 3.31890263573950e-17i,6.48030566693272e-17 - 6.01811686492727e-18i,2.61258768882713e-17 + 5.94447351782249e-17i,2.93291588923318e-17 + 5.71278333128274e-17i,6.27055582110247e-17 - 1.43787279839822e-17i,-6.08304716281811e-17 - 2.00319598775529e-17i,5.87171359604211e-17 - 2.56627353490203e-17i,4.81829902256827e-17 + 4.16677066343584e-17i,5.36540799120973e-17 + 3.41413685118690e-17i,4.11056914745718e-17 - 4.77272761225408e-17i,-5.72782996508598e-17 + 2.57173934334099e-17i,1.92047035283830e-17 - 5.98711138904635e-17i,6.07737204299148e-17 - 1.46586094956158e-17i,5.52595444208072e-17 - 2.90739072719197e-17i,-2.65054570369899e-17 - 5.59886042220397e-17i,6.40708232066639e-18 + 6.14270792173854e-17i,-5.30640744153298e-17 - 3.15676751075530e-17i,-6.54280474368610e-18 - 6.12750502530800e-17i,-2.64134483839016e-17 - 5.50744367914323e-17i,-5.33495430287891e-17 + 2.80523222103781e-17i,5.91474144047507e-17 - 1.50001367725644e-17i,-1.73972165436493e-17 + 5.77640893020245e-17i,-5.45773836208371e-17 + 2.51739305839547e-17i,-3.92721385152734e-17 + 4.60761848038096e-17i,5.00557999507655e-17 + 3.26100561050040e-17i,-4.39891587779343e-17 - 4.04838661676904e-17i,5.58443149228176e-17 - 2.04558839042403e-17i,5.41536235374435e-17 + 2.41011905699344e-17i,5.89486195795316e-17 - 5.36145265974894e-18i,-1.64962547636913e-17 - 5.63983134556684e-17i,1.08624726601859e-17 + 5.78691751314494e-17i,-5.68452129614228e-17 - 1.32889617820105e-17i,-3.43789581907199e-17 - 4.69397719857453e-17i,-1.71389397903618e-16 - 2.19863782621964e-16i,-7.53866608739547e-18 + 5.77433073260150e-17i,1.09466949389099e-17 - 5.73121326569272e-17i,4.93321195268839e-17 + 3.05939567472166e-17i,1.91786139170058e-17 + 5.47568713980616e-17i,4.57090249096527e-17 + 3.43931258367575e-17i,2.07250541331390e-17 - 5.31040842784195e-17i,-2.30238149976043e-17 + 5.27173863093849e-17i,-4.12867081783404e-17 - 3.94603622339473e-17i,-7.32693869743263e-18 - 5.67142366492094e-17i,6.02096687185404e-13 + 2.60611288483711e-13i,-3.16326884645089e-17 + 4.71722466571738e-17i,3.45589055506914e-17 - 4.42910042377991e-17i,2.79614964867038e-17 + 4.85967834800823e-17i,-9.98294972791062e-18 + 5.52853292542124e-17i,1.88914270179900e-17 + 5.22406028052526e-17i,4.81113975099576e-17 - 2.88892126448399e-17i,-5.10139855728802e-17 + 2.16879415153306e-17i,4.03082078620374e-18 - 5.56530232611903e-17i,4.34542114065984e-17 - 3.36724433847836e-17i,-2.01209989313202e-10 + 5.74936566852204e-10i,-4.89087194348907e-17 - 2.52824637983588e-17i,3.84676548466303e-17 + 3.88848507202770e-17i,-5.49852172212496e-17 + 6.18698386456344e-18i,-3.21670798160839e-17 - 4.46040963026925e-17i,-3.86532298091011e-17 - 3.88093133095360e-17i,-4.72782889216065e-17 + 2.74932246183970e-17i,5.44335597311451e-17 + 5.80736369744537e-18i,-4.89708874877466e-17 + 2.26791782596586e-17i,-2.75815183463933e-17 - 4.68381172037175e-17i,-2.12265030596800e-07 - 2.38222220696835e-07i,-4.58505287818141e-17 - 2.74756338092360e-17i,-1.10657783061782e-17 + 5.21002190072290e-17i,1.71508840909159e-17 - 4.99829868922682e-17i,2.94430343293957e-17 + 4.45911719765812e-17i,-2.88487350328752e-17 + 4.43086160373895e-17i,-3.50068829436616e-17 + 3.95906593176764e-17i,5.61087224345965e-18 + 5.20816967621026e-17i,4.94154391061954e-17 - 1.68026737111328e-17i,-5.17844804591959e-17 - 1.11442528187160e-18i,0.00299560041494625 + 0.000522976341312387i,-4.34805863661176e-17 + 2.79364841818700e-17i,-3.88613128376641e-17 - 3.30725818690209e-17i,-5.81064999306872e-19 - 5.04893294631718e-17i,2.25005103953756e-17 - 4.44542475888885e-17i,3.33654941168013e-17 - 3.63591119391084e-17i,4.11689269181957e-17 - 2.54102249299286e-17i,4.75961685474692e-17 + 1.35152391172277e-18i,1.19916712850313e-17 + 4.54214664496032e-17i,-3.59450910082047e-17 - 2.83667606171637e-17i]*Res.Temp.Space.N;
%    Res.Temp.In.Psi_Start(Res.Temp.Space.N+1:2*Res.Temp.Space.N) = [-0.00720036880957153 + 8.20050538565458e-05i,-1.17280028578671e-18 - 1.52242460827456e-19i,3.75897395556123e-19 - 1.49330984621453e-18i,1.86894712157128e-18 - 4.23114874109532e-19i,6.58568263727078e-19 - 7.55018688463239e-19i,5.61336517904112e-19 + 1.13474234307179e-19i,1.06478462781869e-18 - 8.71140064782785e-19i,2.15975542713402e-20 + 1.01520286652679e-18i,1.53972939042846e-19 - 3.30307802974818e-19i,-1.04855776196556e-18 + 7.11858371782097e-19i,-0.00103347165665546 + 4.44609825824773e-06i,7.27794133315425e-19 - 5.46252385148571e-20i,2.62354649218074e-19 + 1.20524799051229e-19i,5.73922580256133e-19 - 1.69583254695057e-19i,-1.14362693323550e-18 + 5.20241976763307e-19i,1.14683449577479e-18 + 1.60834178862211e-18i,-4.22647795223109e-18 + 5.19857445400582e-18i,-5.54067090763024e-19 + 7.91269521453884e-19i,6.62586093182658e-19 + 1.34361825373357e-18i,-1.72539071684807e-18 + 2.47946322934048e-20i,5.07608699877314e-09 - 9.57361826953341e-08i,2.47490831792992e-18 - 8.39694270775709e-19i,-9.06409548054590e-19 - 1.26542880846384e-18i,-7.09440303425488e-19 - 7.69004185217942e-19i,-4.77484952140045e-19 + 1.76762837136626e-18i,-3.81201128959550e-19 + 1.07530993452856e-18i,1.34114095957192e-18 + 1.63793098228578e-20i,-9.00026959273535e-20 + 4.19487330069316e-19i,-1.14834303044205e-19 + 8.95283071246965e-19i,5.06788923577124e-19 + 1.30374601463647e-18i,1.84168913626490e-11 + 9.43658073112411e-11i,5.66367239169683e-19 - 9.58300873870004e-20i,1.08771990284770e-18 - 8.89228160653035e-19i,6.33338902005720e-19 - 7.36083892823792e-19i,4.76013419748875e-19 - 1.55140595757153e-19i,7.43267584044538e-19 + 2.12819733883393e-19i,-1.41223402593769e-19 - 6.33950986063864e-19i,-4.52236773688638e-19 + 5.83289552910031e-19i,-6.41127460837943e-19 - 2.13411443042325e-19i,-1.15859562834952e-18 - 1.30501858209232e-19i,-1.26954617765129e-13 + 4.07220990893769e-14i,7.55127649434481e-19 + 3.67085171291295e-20i,1.69521788870227e-19 + 5.63223681110677e-19i,-1.18588143929660e-18 + 8.97985144030210e-20i,-3.73459430117518e-19 + 4.32278264128263e-19i,-1.68957965051535e-19 + 8.97564411017523e-19i,-1.91424999325587e-19 - 3.16964464331187e-19i,2.51646681624568e-19 - 5.26619192347027e-20i,2.93625867835551e-19 + 6.99526921473392e-19i,-1.87778059921678e-19 - 6.10766474596395e-19i,1.11702201749661e-17 - 2.84762068452122e-17i,-7.34142948330805e-19 - 2.68515933949995e-19i,-4.63970969919595e-21 - 2.06494079057251e-19i,-3.64181953697721e-19 - 8.08518387857906e-19i,-7.29397073213473e-19 + 8.14124286998835e-20i,4.47054903420098e-19 + 2.83784022784704e-19i,-6.00163415735241e-19 - 1.04510762228850e-19i,-5.30607740325892e-19 - 7.18834878881227e-20i,-2.48335653447217e-19 + 2.55448630719571e-19i,2.04354861070257e-19 - 2.68867365488493e-20i,-6.61627692258896e-19 + 6.68404509314879e-20i,4.11437863520951e-19 + 8.25781853565211e-20i,4.09701973880030e-19 - 2.85683876739347e-19i,2.08367534383868e-19 - 5.26129880168929e-19i,-9.68948883570444e-19 + 1.66174633721451e-18i,2.77702590233743e-19 - 2.68375723747298e-19i,-1.75451763834550e-19 + 6.18819762670757e-19i,1.55841988022450e-19 - 5.64534165121484e-20i,3.27349839688084e-19 - 1.04851575652251e-19i,-2.86636096619085e-19 - 1.20545651350462e-19i,5.22278880561464e-19 - 3.35754784559542e-19i,3.31778986770491e-19 - 1.73577931569295e-19i,6.63179456148058e-19 - 6.42588945954687e-19i,-2.63751921631104e-19 - 2.20220631795147e-19i,-2.61744287944006e-19 + 2.74511614536662e-19i,-2.24364305219854e-19 - 2.29694512409418e-19i,4.63729373398297e-19 - 1.75380734412179e-19i,2.71527031647692e-19 - 2.60341263038936e-19i,-3.88899693135530e-19 + 5.92029082598077e-19i,1.81647124494825e-19 + 1.59349882987535e-21i,7.54750860100009e-19 + 3.75001137705704e-20i,9.32375964975428e-20 + 7.98109637805186e-20i,-3.88246970147875e-19 - 5.84568878616132e-20i,6.46898057505887e-20 + 1.41103974603979e-19i,-3.92820513014366e-19 + 3.86566859255999e-19i,3.04561308043016e-19 - 2.27133031303196e-19i,-1.43364643517680e-20 + 1.15596211296069e-19i,7.62766219015488e-20 - 1.54042917080450e-19i,-3.26280836587850e-19 - 4.27891434119181e-19i,3.00739696976952e-19 - 5.76687006838766e-20i,3.89400430541877e-19 + 1.60916785964083e-19i,2.48213578392577e-19 + 3.22233272899801e-19i,-2.48452004614225e-19 - 1.75676931124890e-19i,-2.16534625784823e-19 - 1.81263048791359e-19i,3.26265521793895e-19 + 1.59820401534003e-19i,-1.79330569827706e-19 - 1.24782747732402e-19i,5.28736667822386e-19 - 1.18854831559387e-19i,3.95627798642509e-20 + 3.36972901420987e-19i,-3.18580386828486e-20 + 9.86356550376601e-20i,-2.53312770006415e-19 - 1.40633930283732e-19i,-3.45383970377092e-19 + 3.94829279394427e-20i,-3.21749180747108e-19 - 4.96014817756924e-20i,-2.34955927770586e-19 + 3.11322920294943e-19i,-3.67984423056202e-20 - 4.61722433657354e-20i,-3.68273308092750e-19 + 3.90341857774706e-19i,-2.29756271684525e-19 - 1.30640272126618e-19i,1.60060677992987e-19 + 3.90316397058631e-19i,4.73087621418443e-20 + 1.67361747271092e-19i,-3.69112864132421e-19 + 2.59190258106593e-19i,1.86405444153467e-19 + 2.73241650468825e-19i,-1.95901081499974e-19 + 1.12866131447773e-19i,-1.18159592661454e-20 + 1.23742162478524e-20i,-3.73948447273095e-20 - 8.13558853523440e-20i,1.30337700090633e-20 - 3.84057589480880e-19i,1.89771828041571e-20 - 4.05776565931353e-19i,2.58982313466396e-19 - 7.68476741425913e-20i,5.05266759418643e-19 - 4.07282687419051e-19i,-2.25355677020023e-19 - 1.50519538707693e-19i,-3.86218912376653e-19 + 2.43295939572542e-19i,-2.61089403481333e-19 + 1.03693830551410e-19i,-3.06814828112876e-19 - 4.73858918346362e-19i,-2.48010884729568e-19 - 1.12477486222331e-19i,2.53413929449438e-19 + 2.96022982397458e-19i,-3.13521284437489e-19 - 1.62645063007807e-19i,2.38576281263455e-19 - 5.87991358496761e-19i,-1.73378236321795e-20 + 1.57450533704309e-19i,3.28287811152688e-19 - 5.56925892553960e-20i,-3.95817062938317e-19 - 7.16818558090004e-20i,4.80105174508724e-20 + 9.88043691282908e-19i,1.11017392272209e-19 + 1.18739979573773e-19i,3.66706467822969e-20 - 2.18852352570541e-19i,8.43244618357568e-20 + 3.44661473790854e-20i,4.83769347795941e-20 + 5.07990070206334e-19i,1.04075307488203e-19 - 1.47758933774769e-19i,-2.51435608426381e-19 + 2.37198968877639e-19i,-1.40215999019590e-19 + 8.23830779868768e-20i,-6.60255972744717e-19 + 1.64221067617596e-19i,-1.48629495377606e-19 - 2.48426647134978e-19i,-4.56561392741789e-19 + 1.55628086135312e-20i,-1.18739359116981e-19 - 3.01696947229549e-20i,8.59403422121544e-20 + 3.77239910248675e-19i,-1.26010238478026e-19 - 4.34579270047381e-20i,5.34957251071853e-20 + 3.77689077229449e-19i,2.85964458029112e-19 + 2.08004016057410e-19i,-1.53427277426336e-19 + 1.15009370779123e-18i,1.96956138751478e-19 + 9.66797496102097e-20i,-5.36481138422413e-20 + 1.19644182357034e-19i,2.12071224887134e-19 - 2.46161619127557e-19i,2.88570334640943e-19 + 4.48859904377650e-20i,4.39693628920634e-20 + 5.46903910948155e-20i,-9.39659123681223e-19 + 3.20867031310982e-19i,-6.65699495839937e-21 + 2.27670131449222e-20i,-1.09971966659404e-18 - 4.72536800059153e-19i,2.87876047119986e-19 + 2.09623810601297e-21i,-1.59253597510028e-19 - 1.89001429499348e-19i,9.35565041899193e-20 - 2.26318233790392e-19i,1.88023570585192e-19 - 2.65144772397559e-19i,-2.22842064034396e-19 - 1.84530914069243e-19i,1.42857917315221e-19 + 2.22082286211500e-19i,1.90350291684125e-19 - 2.18264048064719e-19i,3.35567227557854e-19 + 8.31905686225718e-20i,7.03894284090982e-20 + 4.11785295972402e-20i,1.13836975208394e-19 - 6.87396410994643e-20i,2.52315978570844e-19 - 4.86507401464730e-20i,-5.45006189320731e-20 - 2.18303880941535e-19i,-3.49842491528051e-19 - 1.63957098665742e-20i,1.14748625607424e-19 - 9.51583732553222e-21i,2.72520486512359e-19 + 1.60482427260342e-19i,-8.93993247599017e-19 - 5.34918532306939e-19i,-2.27824178175373e-19 + 1.28833372531999e-19i,-6.52821226187449e-19 + 2.14445528256703e-20i,-2.49717038907306e-19 + 1.23485467771746e-19i,2.47823607799857e-19 - 5.22197607871042e-20i,8.24640456714089e-21 - 4.34160125843135e-20i,-6.90692879257670e-20 + 1.80725830419273e-19i,2.30842360100282e-20 + 1.53240460660295e-19i,-9.66565399435024e-20 - 1.50038456701872e-19i,-5.97298947898947e-20 + 1.54330640600094e-19i,5.14313544535633e-19 + 6.16995904048149e-20i,1.69217389322030e-20 + 2.50312167636555e-19i,-2.59470960173736e-19 + 5.89322206640756e-20i,-1.94512178561064e-19 + 2.35463950492470e-19i,4.94437967946595e-19 + 4.51569349907723e-19i,-1.11781985389192e-19 - 2.12467800641069e-19i,5.12564457079066e-19 - 1.38764411385781e-19i,4.75051836642225e-20 + 1.32035498159538e-19i,-1.37699735619967e-19 + 2.45040619771914e-19i,2.72928462578818e-19 - 3.95980907694106e-19i,4.21420293646466e-21 - 7.66416120614870e-20i,2.79755811321628e-19 + 9.57314753691237e-20i,-1.81482046907319e-19 - 2.78244697026040e-19i,3.92634189919665e-19 - 2.17512803895528e-19i,-1.66981346608592e-18 - 9.62798026938459e-19i,3.20912063123066e-19 - 5.88930555242557e-20i,-2.64087476315196e-19 + 2.98470297636851e-20i,-5.14927986132262e-20 - 6.73826775456464e-19i,1.58264951837645e-20 - 3.63846599914201e-20i,3.54683704956421e-20 + 1.63103081035034e-19i,-6.42945557025003e-20 - 1.72245151535140e-19i,3.12621303006542e-19 + 1.50785610640233e-19i,-9.49037903510820e-20 + 1.15432517751597e-18i,2.14790653324839e-19 + 3.77706809421326e-19i,1.95827969224093e-19 - 2.10371589213267e-19i,-3.45213249310253e-19 - 1.17684929857611e-19i,-5.36151624117654e-19 - 6.35010332249439e-19i,6.62156779724795e-19 - 2.27120932373823e-19i,1.92574852370980e-17 + 9.37585477890407e-18i,-4.50022951931801e-19 - 7.06628048834159e-20i,1.84955380951286e-19 + 4.90327562106800e-19i,-3.48603946234496e-19 - 1.69116071707151e-19i,-3.33170377195810e-19 + 1.78840270879368e-20i,-3.06104077719277e-19 - 3.77814655610193e-19i,2.97862897737069e-19 + 9.09173770186021e-20i,-5.34744867020920e-19 + 1.99880649826023e-20i,1.61694640393434e-19 - 6.24330657853686e-21i,5.14866655941430e-20 - 1.55068527748815e-19i,-1.24133144717782e-14 + 2.35278283677429e-14i,-1.93276806478985e-19 - 5.30345801200377e-19i,5.62637068184320e-19 - 2.65641551974974e-19i,-2.30342640097670e-19 + 2.91613138750529e-19i,-4.30208812533372e-19 + 2.48610288995932e-20i,-8.38812050088739e-19 - 6.12024544437638e-19i,-2.01817045704600e-19 + 5.99373188336719e-19i,-5.36939160186763e-19 + 3.09414636163031e-19i,1.15262509379174e-18 - 6.71563537975389e-19i,3.05832759690075e-19 + 1.12917378952363e-19i,-1.18670746825241e-11 - 1.38134117098029e-11i,7.38809459732213e-19 - 4.43367906709597e-19i,-5.11958982484849e-19 - 2.20954955978384e-19i,1.31405224136915e-19 - 5.40770932249614e-19i,5.13287534639425e-20 - 2.97852436772685e-19i,4.88220869323205e-19 + 3.93566067402370e-19i,-1.27411400376390e-18 - 8.06529932564828e-19i,-1.93753451380179e-20 + 3.51084118015627e-19i,4.39281004768350e-20 - 3.43413437456291e-19i,1.62180279112028e-19 - 3.57306124920740e-19i,8.93725853250028e-08 + 2.93100947450808e-08i,-6.70005659550089e-20 - 1.18948138480487e-18i,-5.98760568010952e-19 - 2.89426313237986e-19i,5.38672862201150e-19 + 5.66044618556487e-19i,-1.42993992434935e-18 + 2.93630689172877e-18i,-8.09357896875896e-19 + 7.36174887050825e-20i,-7.23216130421211e-19 - 4.91696758146662e-19i,-7.01149741959751e-19 - 1.75665629186446e-21i,8.55781096548597e-19 + 2.11949010962537e-20i,1.82603840149163e-19 - 8.50503639712857e-19i,-7.40680131759202e-06 + 4.39033386925137e-05i,4.60303697084093e-19 - 6.68785771832469e-19i,1.40412567792642e-18 - 3.01584633279740e-20i,9.41699203540102e-19 - 1.77970034729270e-19i,6.48762483251379e-19 + 7.43083261157305e-19i,6.03148980364611e-19 + 2.43859551814839e-19i,9.10052245082505e-20 + 9.54768420936287e-19i,-7.51003283955156e-19 + 1.88845746525354e-18i,-1.07237525191224e-18 + 1.38445850088886e-19i,8.71573508860546e-19 - 5.61560820873004e-19i]*Res.Temp.Space.N;
%     Res.Temp.In.t_start                 =50;

        ResSave(i).Temp.Met      = [];

        tic
        ResSave(i).Temp.Sol      = Chi23_Runge_Kuarong_mex(ResSave(i).Temp,Runge);
        toc
    end
%%
   Res.Stat.In           = Res.CW.In;
    Res.Stat.Par          = Res.CW.Par;
    
    Res.Stat.In.N         = 2^9;
    Res.Stat.Met.Newton   = @Newton_Manual_bicgstab;%'fsolve'
    
    Res.Stat              = Res.Stat.Met.Norm(Res.Stat);
    
    Res.Stat.Sol.Psi_o    = 1E-10*ones(1,Res.Stat.Space.N);
    Res.Stat.Sol.Psi_e    = 1E-10*ones(1,Res.Stat.Space.N);
    
%    Res.Stat.Sol.Psi_o(1) = Res.Temp.Sol.Psio(end-1,1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(2) = Res.Temp.Sol.Psio(end-1,1+13)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(3) = Res.Temp.Sol.Psio(end-1,1+13*2)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(4) = Res.Temp.Sol.Psio(end-1,1+13*3)*Res.Stat.Space.N;
%     
%     Res.Stat.Sol.Psi_e(1) = Res.Temp.Sol.Psie(end-1,1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(2) = Res.Temp.Sol.Psie(end-1,1+13)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(3) = Res.Temp.Sol.Psie(end-1,1+13*2)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(4) = Res.Temp.Sol.Psie(end-1,1+13*3)*Res.Stat.Space.N;
%         
%     Res.Stat.Sol.Psi_o(end) = Res.Temp.Sol.Psio(end-1,end-13+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(end-1) = Res.Temp.Sol.Psio(end-1,end-13*2+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(end-2) = Res.Temp.Sol.Psio(end-1,end-13*3+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(end-3) = Res.Temp.Sol.Psio(end-1,end-13*4+1)*Res.Stat.Space.N;
%     
%     Res.Stat.Sol.Psi_e(end) = Res.Temp.Sol.Psie(end-1,end-13+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(end-1) = Res.Temp.Sol.Psie(end-1,end-13*2+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(end-2) = Res.Temp.Sol.Psie(end-1,end-13*3+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(end-3) = Res.Temp.Sol.Psie(end-1,end-13*4+1)*Res.Stat.Space.N;

    Res.Stat.Sol.Psi_o = Res.Temp.Sol.Psio(end-1,:)*Res.Stat.Space.N;
    Res.Stat.Sol.Psi_e = Res.Temp.Sol.Psie(end-1,:)*Res.Stat.Space.N;

    Slv_Start             = [real(Res.Stat.Sol.Psi_o),imag(Res.Stat.Sol.Psi_o)...
                    ,real(Res.Stat.Sol.Psi_e),imag(Res.Stat.Sol.Psi_e),0.];
                
    [Slv,eps_f,Exitflag] = Newton_Switcher(Slv_Start,Res.Stat);
    
    Res.Stat.Sol.Psi_o   = (Slv(1:Res.Stat.Space.N) + 1i*Slv(Res.Stat.Space.N+1:2*Res.Stat.Space.N))/Res.Stat.Space.N;
    Res.Stat.Sol.Psi_e   = (Slv(2*Res.Stat.Space.N+1:3*Res.Stat.Space.N) + 1i*Slv(3*Res.Stat.Space.N+1:4*Res.Stat.Space.N))/Res.Stat.Space.N;
    Res.Stat.Sol.V       =  Slv(end);
    
%   Res.Stat.Stab          = Stability_Switcher(Res.Stat);
%%
        Plot_Res_temp(ResSave(70));   
%%
    for i=1:size(ResSave,2)
        delta(i)    = ResSave(i).Temp.Eq.delta_o;
        PowerF(i)= sum(abs(ResSave(i).Temp.Sol.Psio(end-1,2:end)).^2);
    end
figure;
plot(delta,PowerF,'LineStyle','none','Marker','.')
%% гауссов импульс умножить на кусок пси потом фурье (фу) (функция вигнера xfrog) 

%%

    for i = 3:9

        Plot_Res_temp(Res(i));
        h = gcf; 
        print(strcat(num2str(i)),'-dpng','-r450');

    end
    %%
    for i = 1:8
      delta_150(i) = Res(i).Temp.In.delta_o/Res(i).Temp.In.ko;
      conv_eff_eps_150(i) = sum(abs(Res(i).Temp.Sol.Psie(end-1,:)).^2)/sum(abs(Res(i).Temp.Sol.Psio(end-1,:)).^2);
      
      delta_100(i) = ReSS(i).Temp.In.delta_o/ReSS(i).Temp.In.ko;
      conv_eff_eps_100(i) = sum(abs(ReSS(i).Temp.Sol.Psie(end-1,:)).^2)/sum(abs(ReSS(i).Temp.Sol.Psio(end-1,:)).^2);
    end
%%
function Plot_Frog(ResSave,wd)
    
    
    a = max(abs(ResSave.Temp.Psi_o(end,:),2));
    U_Frog = zeros(ResSave.Temp.Space.N,ResSave.Temp.Space.N);
    for i = 1:ResSave.Temp.Space.N
        U_Frog(i,:) = fft(ResSave.Temp.Psi_o(end,:).*a.*exp(-(ResSave.Temp.Space.phi-ResSave.Temp.Space.phi(i)).^2/2/wd^2 ));
    end

end

function Plot_Res_temp(ResSave)

    indmu = 1;
    indt  = 1;
    ind_t = [size(ResSave.Temp.Sol.Psio,1)/2+1:1:size(ResSave.Temp.Sol.Psio,1)];
    Nt    = size(ind_t,2);
    T     = ( ResSave(indt).Temp.Sol.t(ind_t(end)) - ResSave(indt).Temp.Sol.t(ind_t(1)) );
    dt    =   ResSave(indt).Temp.Sol.t(ind_t(end)) - ResSave(indt).Temp.Sol.t(ind_t(end-1));
    
    f = 2*pi*ResSave(indt).Temp.Eq.norm/( ResSave(indt).Temp.Sol.t(ind_t(end)) - ResSave(indt).Temp.Sol.t(ind_t(1)) )/ResSave.Temp.In.ko*[0:Nt/2-1,-Nt/2:-1];
    
    PsiO = ifft(ResSave(indt).Temp.Sol.Psio,[],2);
    PsiE = ifft(ResSave(indt).Temp.Sol.Psie,[],2);
    
    PsiOt = zeros(Nt,ResSave(indt).Temp.Space.N);
    PsiEt = zeros(Nt,ResSave(indt).Temp.Space.N);
    
    for i = 1:ResSave(indt).Temp.Space.N
        
        PsiOt(:,i)    = ifft(ResSave(indt).Temp.Sol.Psio(ind_t,i)*ResSave(indt).Temp.Space.N );        
        PsiEt(:,i)    = ifft(ResSave(indt).Temp.Sol.Psie(ind_t,i)*ResSave(indt).Temp.Space.N );
        PowerOmuavg(i) = dt/T*sum(abs(ResSave(indt).Temp.Sol.Psio(ind_t,i)).^2);
        PowerEmuavg(i) = dt/T*sum(abs(ResSave(indt).Temp.Sol.Psie(ind_t,i)).^2);
        
    end
    
    figure('Position',[0,0,1000,800],'Color',[1,1,1]);
    
    Panel = tiledlayout(4,2,'TileSpacing','none','Padding','none');   
   
    ax(1) = nexttile(Panel,1,[1,2]);hold(ax(1),'on');  
    ax(2) = nexttile(Panel,3,[1,1]);hold(ax(2),'on');  
    ax(3) = nexttile(Panel,4,[1,1]);hold(ax(3),'on');  
    ax(4) = nexttile(Panel,5,[1,1]);hold(ax(4),'on');  
    ax(5) = nexttile(Panel,6,[1,1]);hold(ax(5),'on');  
    ax(6) = nexttile(Panel,7,[1,1]);hold(ax(6),'on');  
    ax(7) = nexttile(Panel,8,[1,1]);hold(ax(7),'on');  
    
  %  plot(ResSave(indt).Temp.Sol.t(1:end-1),  sum(abs(ResSave(indt).Temp.Sol.Psie(1:end-1,:)).^2,2),'Parent',ax(1),'Color',[0,1,0]);
   plot(ResSave(indt).Temp.Sol.t(1:end-1),  sum(abs(ResSave(indt).Temp.Sol.Psio(1:end-1,2:end)).^2,2),'Parent',ax(1),'Color',[1,0,0]);
  %  plot(ResSave(indt).Temp.Sol.t(1:end-1),  sum(abs(ResSave(indt).Temp.Sol.Psie(1:end-1,1)).^2,2),'Parent',ax(1),'Color',[0,1,0]);

   % ylim(ax(1),[0,sum(abs(ResSave(indt).Temp.Sol.Psio(end-1,:)).^2*1.4,2)])
    
    stem(fftshift(ResSave(indt).Temp.Space.k),fftshift(10*log10(abs(ResSave(indt).Temp.Sol.Psio(end-1,:)).^2 )),'Parent',ax(2),'Color',[1,0,0],'BaseValue',-100,'Marker','none'); 
    stem(fftshift(ResSave(indt).Temp.Space.k),fftshift(10*log10(abs(ResSave(indt).Temp.Sol.Psie(end-1,:)).^2 )),'Parent',ax(2),'Color',[0,1,0],'BaseValue',-100,'Marker','none'); 
    
    stem(fftshift(ResSave(indt).Temp.Space.k),fftshift(10*log10( PowerOmuavg)),'Parent',ax(3),'Color',[1,0,0],'BaseValue',-100,'Marker','none'); 
    stem(fftshift(ResSave(indt).Temp.Space.k),fftshift(10*log10( PowerEmuavg)),'Parent',ax(3),'Color',[0,1,0],'BaseValue',-100,'Marker','none'); 

    plot((ResSave(indt).Temp.Space.phi),abs(ifft(ResSave(indt).Temp.Sol.Psio(end-1,:)*ResSave(indt).Temp.Space.N)).^2 ,'Parent',ax(4),'Color',[1,0,0]); 
    plot((ResSave(indt).Temp.Space.phi),abs(ifft(ResSave(indt).Temp.Sol.Psie(end-1,:)*ResSave(indt).Temp.Space.N)).^2 ,'Parent',ax(5),'Color',[0,1,0]); 
    
    pcolor(fftshift(ResSave(indt).Temp.Space.k),fftshift(f),fftshift(fftshift(10*log10(abs(PsiOt).^2),1),2),'Parent',ax(6))
    pcolor(fftshift(ResSave(indt).Temp.Space.k),fftshift(f),fftshift(fftshift(10*log10(abs(PsiEt).^2),1),2),'Parent',ax(7))
    
    ax(1).XLabel.String = '$t,(s \cdot k_o)$';
    ax(1).YLabel.String = '$|\psi_\mu|^2$';
    
    ax(2).XLabel.String = 'Mode Number';
    ax(2).YLabel.String = 'Power (db)';
    
    ax(3).XLabel.String = 'Mode Number';
    ax(3).YLabel.String = 'Power (db)';
%   colorbar(ax(i));
    ax(3).YLim  = [-100,4];
    ax(2).YLim  = [-100,4];
    
    ax(3).XLim  = [-80,80];
    ax(2).XLim  = [-80,80];
    ax(5).XLim  = [-pi,pi];
    ax(4).XLim  = [-pi,pi];
    
    ax(6).XLim  = [-80,80];
    ax(7).XLim  = [-80,80];
    ax(6).YLim  = [-100,100];
    ax(7).YLim  = [-100,100];
    
    caxis(ax(6),[-100,4]);
    caxis(ax(7),[-100,4]);
    
   ff= figure('Position',[0,0,1000,800]/2,'Color',[1,1,1]);
    
   Panel1 = tiledlayout(1,2,'TileSpacing','none','Padding','none','Parent',ff);   
   axx(1) = nexttile(Panel1,1,[1,1]);hold(axx(1),'on');  
   axx(2) = nexttile(Panel1,2,[1,1]);hold(axx(2),'on');  
   
   pcolor(ResSave(indt).Temp.Space.phi,ResSave(indt).Temp.Sol.t(ind_t),abs(PsiO(ind_t,:)).^2,'Parent',axx(1));
   pcolor(ResSave(indt).Temp.Space.phi,ResSave(indt).Temp.Sol.t(ind_t),abs(PsiE(ind_t,:)).^2,'Parent',axx(2));
   
   for i = 1:size(ax,2)
      axes_Style(ax(i));
      shading(ax(i),'flat');
   end
   for i = 1:size(axx,2)
      axes_Style(axx(i));
      shading(axx(i),'interp');
   end

end    

function axes_Style(ax)

     ax.Box      = 'on';
     ax.FontSize = 15;
     ax.TickLabelInterpreter = 'latex';
     ax.XLabel.Interpreter   = 'latex';
     ax.YLabel.Interpreter   = 'latex';
     
end
%%
    
%%

function Temp = Chi23_Temp_Start_CW(Temp,CW)

    Temp.In.Psi_Start                 = 1E-2*ones(1,Temp.Space.N*2);
    Temp.In.Psi_Start(1)              = (CW.Sol.Psi_o)*Temp.Space.N;
    Temp.In.Psi_Start(Temp.Space.N+1) = (CW.Sol.Psi_e)*Temp.Space.N;
    Temp.In.t_start                   = 0;
    
end
