    clear all;

%%
    Res = Set_Up_Methods_For_Chi23_Paper;
    
%%
    
    Res.CW.In         = Params_LiNbd;
    Res.CW.In.eps     = -2*pi*10E9;
    Res.CW.In.delta_o = 0;
    Res.CW.In.N       = 2^6;
    Res.CW.In.W       = 100000*Res.CW.In.W_Star;
    
%%
    Res.CW.Par.Equation_string  = 'Chi23_CW';
    Res.CW.Met.Equation         = @Chi23_CW;
    Res.CW.Met.InitialGuess     = @Chi_3_Stat_In_Guess_Chi_3_LLE_From_CW;    
    Res.CW.Met.Newton           = @fsolve;%'fsolve'
    Res.CW.Par.Change_Space     = 0;
    
    Res.CW.Par.variable         = 'delta_o';  %%'Pump Power';
    Res.CW.Par.first_step       = 0.05; % step for delta measured in delta/kappa
    Res.CW.Par.step_tol         = 0.001;
    Res.CW.Par.step_inc         = 0.00;
    Res.CW.Par.step_dec         = 0.5;

    Res.CW.Par.bot_boundary     = -40; % bottom boundary for delta to search
    Res.CW.Par.top_boundary     =  40; % top boundary for delta to search
    Res.CW.Par.Sol_Re_Sign      = '-';
    Res.CW.Par.Stability        = false;
    Res.CW.Par.Newton_iter      = 30;      
    Res.CW.Par.Newton_tol       = 1E-10;  
    Res.CW.Par.i_max            = 1000;
    
    Res.CW.Par.fsolveoptions     = optimoptions('fsolve','CheckGradients',...
    false,'Display','none','UseParallel',false,'SpecifyObjectiveGradient',false,...
    'Algorithm','trust-region-dogleg','FunValCheck','on',...
    'MaxIterations',1000,'StepTolerance',1E-25,'OptimalityTolerance',1E-25,'FunctionTolerance',10^(-15));

%%
    W_Finish     = 10000;
    delta_Finish = 3;
    
    W                 = [1.3E5,1.738E5];
    delta             = [20,6.852];
    
    Res = Get_to_point(Res,W,delta);
%%
    Res.Temp.In                = Res.CW.In;
    
    Res.Temp.Par.Runge_Type    = 'Runge SSPRK3';    
    Res.Temp.Par.dt            = 1E-5/2;
    Res.Temp.Par.s_t           = 0.01;
    Res.Temp.Par.T             = 50;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
    Res.Temp.Par.dd            = Res.Temp.Par.T/Res.Temp.Par.s_t;
    Res.Temp.Par.CW_num        = 1;
    Runge                      = Define_Runge_Coeff(Res.Temp.Par);

 %%
    Res.Temp.In.N     = 2^8;
    Res.Temp          = Res.Temp.Met.Norm(Res.Temp);   
    Res.Temp          = Chi23_Temp_Start_CW(Res.Temp,Res.CW);

    Res.Temp.In.Psi_Start                 = 1E-5*ones(1,Res.Temp.Space.N*2);
    Res.Temp.In.Psi_Start(1:Res.Temp.Space.N)                    = [0.0201595211558926 - 0.238829424816142i,-2.16015256974252e-19 - 2.82023023543362e-19i,-2.48363772883338e-20 - 3.06709813641625e-19i,5.75441936489295e-19 + 4.69813441184884e-20i,-3.38985265525287e-19 - 8.47278976431954e-20i,1.08248074454046e-18 + 2.21781599968272e-18i,5.23019885238524e-19 - 2.24735610274201e-19i,7.09651989432329e-21 - 7.87640083870081e-20i,-1.58185452871768e-18 + 1.71745560231716e-18i,-4.78224996470831e-19 + 9.76878556471945e-19i,4.20057330654241e-20 + 3.39426160587119e-19i,4.21981644469568e-19 - 3.65346327332007e-19i,-2.67840790273231e-20 - 1.66691500467769e-19i,0.00974526177634820 + 0.0488506901184909i,-9.23092530305574e-21 + 5.50677553793859e-20i,1.12266253453817e-19 - 6.26710602996513e-19i,1.03579915730430e-19 - 1.68384693025889e-19i,-7.13348699197132e-19 - 5.63849688616884e-19i,1.45307299910294e-20 - 1.04326537479645e-19i,-8.55284864131123e-20 + 3.07957801385804e-19i,-3.45344007502692e-20 - 4.53035771347956e-20i,5.87691706019561e-19 - 5.42643127442240e-21i,4.26629758586940e-20 + 1.08697246509730e-20i,-1.30446542374173e-20 - 8.56905150861933e-20i,-4.69296702424770e-20 - 1.80932387531333e-20i,-7.02735464760068e-20 + 5.35795241415632e-20i,-0.000868747835765440 + 0.000770892669669748i,-1.41495065859183e-20 + 5.85777542220047e-22i,1.69896542337085e-20 + 9.45101929789299e-22i,-1.72550642284342e-19 + 1.68149385318157e-19i,-1.49126192062808e-21 - 2.93178526068779e-20i,9.39017323759852e-22 - 4.30272875493645e-21i,-5.17885471236742e-21 - 3.79828606775511e-21i,-1.75382762960693e-20 - 1.85256971428165e-20i,1.39712979394488e-20 + 3.99528122294135e-21i,5.26705359560567e-21 + 1.49782472965733e-20i,1.62439643946417e-21 + 2.66869502616183e-21i,3.81590812943978e-20 + 1.06995591877110e-20i,1.58460916739912e-21 + 4.77293168818670e-21i,2.31153186439823e-06 - 7.05010283076857e-06i,-9.96231588087997e-21 - 1.72114935228391e-21i,-1.62579711001289e-20 + 8.65436587074580e-21i,-3.91433763573491e-21 - 1.61810561323079e-20i,-2.87003100709617e-21 + 2.56836762640344e-21i,2.34009123456066e-21 - 4.22939545909006e-22i,9.04068347201165e-21 - 3.70481576440886e-20i,1.23393173048250e-21 - 1.57923745205787e-21i,-2.57829226872748e-21 - 2.83848679034739e-22i,6.57270040507687e-21 + 1.65122684035760e-20i,-5.30823222036213e-21 - 8.95521983518853e-21i,2.74812632940450e-21 + 1.96201923748817e-21i,4.46449638654239e-21 + 7.52158619591974e-21i,8.30330076176391e-08 - 1.98882629380183e-08i,1.79034674946630e-20 + 8.44942853657135e-21i,-1.03041140098769e-21 + 1.93564195759471e-21i,1.85408968088188e-21 - 3.52055560096142e-24i,-1.66778861060429e-21 - 2.46615512365248e-21i,-1.48002675924885e-21 - 5.70108444151839e-22i,1.10197882691516e-20 + 8.63688041848510e-21i,2.27664048687923e-21 - 4.60976027665329e-21i,-5.39253893508657e-22 - 2.12064715285869e-21i,8.69689017542021e-21 - 1.89804467686785e-20i,-1.46794547565447e-21 - 1.58345274368310e-21i,-5.25806653649757e-21 + 3.80441184252958e-21i,3.29133235095730e-21 + 1.19681875844413e-21i,4.89432683127704e-10 + 1.03696093257375e-10i,-2.45111527536889e-21 - 1.50040718728833e-21i,-2.06206957154504e-21 - 2.27799950421237e-22i,-8.60458029902746e-22 + 4.24503301397092e-23i,6.60333207973306e-21 - 5.05495999134791e-21i,7.11542355997154e-22 + 1.03817825001143e-21i,-1.99307644682202e-21 - 2.47763738118281e-21i,-5.68192184488343e-21 - 2.53440057190128e-21i,-2.37175587993151e-21 - 2.16517845543405e-21i,1.06436833507063e-20 + 1.18289975268113e-21i,-2.70504526317294e-21 + 1.66507953552666e-21i,1.58236946735251e-22 + 2.13480834231237e-22i,-1.08179099132434e-20 - 8.39249314111081e-21i,4.46421783888763e-12 + 3.91932485778030e-12i,1.26917328154924e-22 + 2.21360579465906e-21i,5.20588448905812e-21 - 4.50355912919933e-21i,-2.19673602035497e-21 - 1.29944968708088e-21i,2.64215803101769e-22 + 2.29017252313095e-21i,5.00945107801448e-21 + 3.20963371157577e-21i,-2.52799609913818e-21 + 2.16513546874142e-21i,4.49074526462996e-21 - 1.94646592331617e-21i,7.51423057672578e-22 + 5.29478381939431e-22i,-1.82610166189925e-21 + 4.15170606913995e-22i,6.61270234423424e-22 + 4.03856658071822e-21i,-2.45724001143634e-21 + 1.04698247089906e-21i,5.58453188108862e-22 - 5.17959668064360e-21i,-2.57824799563116e-14 + 5.77626485837318e-14i,-3.56834417647504e-21 - 1.54265003982819e-21i,7.01898460056403e-21 - 7.43501108284853e-21i,1.42253454703682e-21 + 6.96633259837097e-22i,-3.18151602897772e-21 - 2.74232137572445e-21i,2.42557183837951e-21 - 1.40027613843670e-21i,7.95589138030736e-22 - 3.38644530137359e-21i,-2.33536804128828e-21 - 8.41543630930954e-22i,5.55899405478417e-21 - 9.35521473550538e-21i,-8.16308726395227e-22 - 1.05727410190057e-21i,1.40915063902105e-21 + 6.22594893124596e-21i,1.25712326226132e-21 + 4.45292143115667e-21i,3.93643842974404e-21 - 2.11774039745706e-21i,-3.60538726061275e-16 - 1.79422470118062e-16i,1.39281902041424e-21 + 2.26261756381237e-21i,4.67854213128973e-21 + 4.70181473042207e-21i,-7.43626378198576e-22 - 1.11490280536933e-21i,7.52992468683258e-22 - 7.93670358107134e-22i,-5.64463619089825e-21 + 3.89387313928936e-21i,3.51114839652486e-21 + 3.46488985813170e-21i,1.35800740138650e-21 - 7.39903098272205e-22i,6.78274969045952e-21 + 3.27514950403358e-21i,-2.48164409001583e-21 + 2.67320559668322e-21i,-5.43477216399701e-22 - 2.14311766228832e-21i,4.50230725762276e-21 + 3.86822867749019e-21i,3.19347641473576e-23 - 7.61188824431341e-22i,3.22601340680687e-19 - 2.68732327986677e-18i,1.86993687003984e-22 + 8.41145495758997e-22i,-5.08504160650595e-21 + 2.73859049104959e-21i,-5.33972984482683e-21 - 1.86296600387507e-21i,2.24999077581533e-21 - 1.81913823052790e-21i,-5.15709751940493e-21 + 4.96776672563354e-21i,-3.77717006061474e-22 - 3.74267028428092e-21i,-4.22353769099753e-22 - 1.94141514952764e-21i,-7.15485230160704e-21 - 1.89965258543074e-21i,-2.54071333108044e-20 - 1.99988684843034e-20i,2.06018526443261e-21 + 1.50870967893669e-21i,4.76129374446198e-21 - 9.69009067040094e-22i,2.79584694340122e-21 - 2.95697810184743e-21i,1.06037020952455e-20 - 2.39743375492853e-20i,2.48826905733692e-21 + 7.58960976392877e-21i,-3.95319263077436e-21 + 7.00726413236381e-22i,1.47796165945411e-19 - 3.92783263564405e-20i,1.58633942780031e-21 + 8.36590667555927e-24i,3.44306084547197e-22 + 3.69426680280821e-21i,2.27201284334118e-21 + 4.90275677307847e-21i,1.04817445154496e-21 + 8.70113882466204e-21i,-7.08436291571374e-21 + 4.49496834023542e-21i,5.19394546199383e-19 - 2.87478794927733e-18i,-2.21840157425754e-21 - 1.51679681152030e-21i,1.24470189659997e-21 - 1.95121593715327e-20i,1.80395891397814e-21 + 4.23602494781796e-21i,6.86763388787434e-22 - 1.68661195074277e-21i,-1.73061303836932e-21 - 2.89072197724642e-21i,2.95645638101641e-21 - 2.60477828312890e-21i,9.51963498032303e-23 + 1.30420157098414e-21i,7.84486924856766e-21 - 4.74954572583567e-21i,2.22776775092742e-21 - 1.10177646087769e-21i,-5.52798720242193e-21 + 2.69762665349027e-21i,-1.76095351880146e-21 - 1.20697364984600e-21i,-2.27194320783144e-21 - 1.42561597951634e-21i,1.39814837452701e-16 - 7.19496184842023e-17i,-2.85000233212884e-21 - 3.54962695101562e-21i,3.47600847159314e-21 + 1.71164035239141e-21i,1.93101298417908e-21 - 3.77387962744502e-21i,-1.21669045962129e-21 + 4.22063496440802e-21i,-5.20699960552120e-21 + 9.34883534049030e-22i,-2.83465010612545e-21 + 2.15216382374480e-21i,1.70671945369956e-21 - 5.63350803220188e-21i,8.38000701841168e-21 + 1.11135561686262e-20i,1.32261794851726e-21 - 2.31287287155385e-21i,-3.58487561838250e-21 + 4.62783222097472e-22i,1.26917258238581e-21 - 1.40453416137848e-21i,-2.28536941840882e-21 + 1.04544966019968e-21i,2.56821887506937e-14 + 7.64680489214302e-15i,2.72721904971538e-21 + 7.87316504412284e-22i,-2.15314645961184e-21 + 1.20575524125043e-21i,6.49890031411975e-21 - 5.35704980044661e-21i,-4.74559983355690e-21 - 5.64294814551165e-21i,-1.45900782286720e-21 + 5.71047694076719e-21i,8.98086297090547e-22 + 1.75228101271558e-21i,2.56665132381406e-21 + 4.76556975113841e-21i,-9.00552232881290e-21 + 3.51755838837113e-21i,1.90609161175895e-21 + 4.36111646804059e-21i,-5.52548899421468e-21 - 1.89548080842987e-21i,7.40250872560758e-21 - 1.08854375478534e-21i,6.57170409956903e-21 + 6.48849006073323e-21i,1.25628122917180e-12 + 4.86830921798732e-12i,-1.02538083247279e-20 + 4.60999948732756e-21i,-2.62363492807066e-21 - 6.59611225014016e-22i,-2.13510531694185e-22 + 7.49333091279490e-21i,-3.83234782866135e-21 + 5.29167714356292e-22i,3.97523898216457e-21 + 2.86083361145731e-21i,6.51845563033401e-21 + 4.72044427683924e-21i,-1.22466563112694e-21 - 1.90218880606778e-21i,-3.19954804967648e-21 - 8.64639522429419e-22i,5.00121311304389e-22 - 2.53643009192544e-21i,6.13872528613813e-22 + 1.34824715436538e-21i,-1.04837312155783e-20 + 1.59046844267426e-20i,-1.75140731765723e-21 + 5.65525166620093e-22i,-2.80677682174623e-10 + 2.08332977915648e-10i,2.75433741791714e-21 + 1.89858043518378e-21i,1.37300811327737e-21 + 1.44069071682874e-21i,2.70755347607515e-21 + 2.65976585343240e-21i,-6.29493179821936e-21 - 3.78920436705088e-21i,1.31998026350691e-21 - 1.97054515877622e-21i,-1.50976783405752e-20 + 8.24912761801579e-21i,1.92636180137715e-21 - 2.33504145450111e-21i,2.60746152536703e-21 - 1.54403696176638e-21i,1.73176539507952e-22 + 1.02717589260645e-21i,3.27373870418622e-21 - 5.93575327214373e-21i,-8.47335755573387e-21 - 9.42870385946326e-21i,1.02887232824512e-21 - 3.05697302746064e-21i,-4.89940729763154e-08 + 4.78684953484868e-08i,-1.91242070821767e-20 - 1.32102206881207e-20i,1.43762956958589e-21 - 4.50828660325301e-22i,2.48113322687835e-22 + 1.61341376416344e-21i,7.61220772443287e-22 + 5.19962730740971e-21i,5.75484928644046e-21 - 1.60750063863305e-21i,2.36652238159222e-22 - 2.57030417187847e-21i,-8.54660180013258e-21 - 4.33108706463199e-21i,3.34631020549980e-21 - 2.93689833414890e-21i,-1.06818767009471e-20 + 3.87393560698130e-21i,-5.26911970323511e-21 - 3.77187515757519e-21i,1.61056197445196e-23 - 2.44630886394292e-21i,-8.67329919542491e-22 - 1.06046489482162e-21i,-7.25199506631801e-06 + 1.75275550887361e-07i,2.03663260126490e-20 - 2.24871932774231e-20i,1.79811315002108e-21 + 1.23313755744047e-20i,3.62666097326948e-22 - 3.44965266039363e-21i,-2.28225612261730e-20 - 4.99166201984631e-20i,2.60958787352242e-21 - 3.88587320879550e-21i,-7.18239885475554e-21 - 3.35897364041069e-21i,-1.55525273795392e-20 + 2.31009693248104e-21i,1.51308156938453e-20 + 1.50845611255344e-22i,-2.56921910466781e-21 + 8.74901242664320e-21i,1.72004500277848e-20 - 1.06566429988397e-20i,-1.51974700203370e-21 + 8.77578338355880e-22i,-2.07253114157778e-20 + 1.82847519057431e-20i,-7.36299069666568e-05 - 0.000218731531227609i,1.30511338135157e-20 - 1.28050547619960e-20i,1.02665100659277e-20 - 6.45657848202585e-21i,9.48520725005586e-21 - 2.55034570316956e-20i,1.77913252378195e-20 + 2.52188669382844e-20i,1.91642933155621e-20 + 1.07524333106066e-19i,-6.00474543531855e-22 + 1.28432220051858e-20i,1.46029056306448e-19 - 4.24672141471573e-19i,-5.41163285578650e-20 + 3.42542746148072e-20i,-2.29708699091032e-19 - 1.16870747176117e-19i,-2.27426001119767e-19 - 2.22210243965225e-19i,9.71790702204827e-20 + 8.04602825130873e-20i,-2.16218184991399e-19 + 5.07152825243176e-20i,-0.0392460820404495 - 0.0316281898088489i,-2.43108248640835e-19 + 2.11243014659456e-20i,-6.02475279185850e-19 + 5.04395099495869e-19i,1.56289381893302e-20 + 1.94904016362599e-20i,4.06687722564383e-19 - 6.84474586873548e-21i,2.22784656056147e-19 + 2.55027314044411e-19i,-5.48541639794563e-19 + 2.26823010800341e-19i,-1.82386752355791e-18 - 3.35071685427134e-18i,-8.67683120657345e-21 + 2.96264509382996e-19i,7.90805954867129e-20 - 1.09655313090883e-19i,-1.51377161284184e-19 - 1.79364869336867e-18i,1.52880639803118e-19 - 3.93649516721036e-19i,2.39133663284078e-20 - 1.07367355682893e-19i]*Res.Temp.Space.N;
    Res.Temp.In.Psi_Start(Res.Temp.Space.N+1:2*Res.Temp.Space.N) = [-0.00162657577034995 - 0.000423444869408961i,-3.38538537662176e-20 + 4.91605290101776e-20i,-8.59429637428525e-20 + 4.45763987993035e-21i,8.03109226786015e-20 - 1.22092296431500e-19i,-4.41543371437217e-20 - 5.26702745642838e-20i,-3.59840242486246e-20 + 2.13382603126430e-19i,1.29971310756912e-20 - 1.07827095729899e-19i,7.36291126576420e-20 - 1.03779835365870e-19i,7.12936874604669e-19 + 3.30275780395843e-18i,-1.14255780531766e-19 + 3.13546470095430e-20i,1.02228088711784e-19 - 2.88730721546273e-20i,6.24020378114172e-20 + 4.65288777922763e-20i,1.36883326304867e-20 + 4.58016253871242e-20i,-0.00237934812325086 + 0.000276542304260352i,-2.91165714768676e-20 - 2.26123076828178e-20i,1.26780650643955e-19 - 6.63115205317827e-20i,-2.17940139416862e-19 - 5.57913392003044e-20i,2.09109302020835e-20 - 7.21999217789300e-21i,4.81676047320006e-21 - 1.27246871118390e-20i,4.10517014755257e-21 - 9.49944716660223e-20i,-4.72589583757849e-20 - 6.25992454925541e-20i,2.69883724936705e-20 - 1.23322355937031e-19i,-4.97476352022390e-20 + 4.22837201813311e-20i,-1.00964983770982e-20 - 3.25448244821118e-20i,-2.66991732883667e-19 + 9.35349146232702e-20i,4.42086143025411e-20 + 1.21668551877359e-19i,3.65794777442085e-05 - 2.61505833692212e-05i,1.29587815429225e-19 + 4.29317092480443e-21i,5.18534041697604e-21 + 3.11786532950758e-20i,-9.41065828813222e-20 - 1.85415402998959e-19i,-6.44209674100113e-20 + 2.39787271782995e-20i,3.21826892566047e-20 - 6.78376291125419e-20i,-9.85331707492257e-20 - 1.85130701721561e-19i,-4.79815748589204e-20 - 5.43445591929754e-20i,2.35979171485298e-20 + 1.36144711968835e-19i,-9.52631148949276e-22 - 1.39691518347475e-19i,-4.53137676955498e-20 - 5.72254397608446e-20i,1.14431179269706e-19 - 3.32945736024091e-20i,-5.24344724309420e-20 - 1.38246702625141e-20i,9.83502837020574e-07 + 7.32939105125461e-07i,7.82911429165265e-20 - 8.00838482022850e-20i,1.13142596580208e-20 - 7.09428155722812e-20i,1.39728908394199e-19 - 6.51067645963763e-20i,-9.54634840338829e-20 + 6.99850847726166e-20i,-5.50627355283541e-20 + 1.62844540935867e-20i,-1.79103202668805e-20 - 5.81325272616323e-20i,-7.14709818489318e-20 - 1.16093750721205e-19i,3.54419035271028e-20 + 3.82222462369376e-21i,-4.09522746054179e-21 + 6.06506643702523e-20i,-9.72812486252867e-20 + 1.40133741735210e-20i,2.08574813300564e-20 + 1.90905879280819e-20i,2.48931480335237e-20 - 1.91542897643364e-20i,-6.30013351214276e-09 + 9.16680461671042e-09i,-1.45307807477446e-20 - 3.60417246619028e-20i,8.00332326816618e-20 - 4.35275328326556e-20i,-2.87380434464885e-20 - 7.83241008186735e-20i,-1.37370177070231e-19 - 4.66530954965440e-20i,1.24469261590702e-20 + 2.38810705514090e-20i,-8.31562329803854e-20 - 2.86561690444320e-20i,-4.61190323355549e-20 + 6.25240659598298e-20i,-5.15304979973941e-20 - 8.41283973906142e-20i,-9.65911815073676e-22 - 5.19645119228536e-20i,1.26253835293151e-20 - 1.67852094542759e-20i,-3.61298739040295e-20 - 7.17690397469758e-20i,8.57720875046241e-20 + 2.83652268862002e-20i,-5.67533647483155e-11 - 1.26110636709389e-10i,8.51161919771370e-21 - 1.78734808895980e-21i,-2.61195158098626e-20 - 6.15898061271795e-20i,-4.52045669664347e-20 + 5.81378697618380e-20i,3.19481944987353e-20 + 5.88112047633243e-20i,1.31408528036089e-20 + 7.39211156351885e-20i,-2.96543133963501e-21 + 1.32738830570601e-20i,1.56589964736035e-19 + 1.44921478958809e-20i,-6.41455842845214e-20 + 5.54877849816693e-20i,9.05817055499515e-20 - 1.10522861351824e-21i,-7.78267945804603e-20 + 2.97163870902147e-20i,8.23126194823676e-20 + 9.59058527486888e-20i,-6.75950335680016e-20 - 9.17533023999081e-20i,6.83792734895784e-13 - 7.77244262129139e-13i,8.97967426692089e-20 - 9.27150985210521e-21i,-3.53122431196528e-20 + 3.89763784234205e-20i,-3.21856516132495e-20 + 6.92265555906288e-20i,-1.08959145228878e-19 + 4.04778409328315e-20i,5.67550197505885e-20 - 1.18307998347090e-19i,-4.05409811624362e-20 - 4.92820384790558e-20i,-4.86646033134348e-20 - 1.08079470841289e-19i,9.90184954003602e-20 - 5.31288815811736e-20i,-5.17783336790121e-20 + 2.81565225796687e-21i,5.52033694648604e-20 - 3.52149670020867e-20i,-1.72815135766858e-19 + 5.41714549011130e-20i,8.86238982849988e-20 + 9.91027292541903e-20i,4.30795158190085e-15 + 5.89897932489768e-16i,-8.86358614043147e-20 + 4.97364662579036e-21i,7.62480609787136e-20 - 4.47211786110927e-20i,-6.34924868672007e-20 - 9.14325164709377e-20i,-1.65312218189800e-21 - 3.95875220132586e-20i,-1.96908709070227e-19 + 4.72992754872972e-20i,7.95028347450246e-20 + 1.61691726164517e-20i,2.48448321335357e-20 + 4.06438314317716e-20i,7.66969483267391e-20 - 1.41764981218491e-21i,3.28197486728593e-21 + 1.45667567902383e-20i,3.69007129938864e-20 + 1.46171095554671e-19i,-8.65850762605490e-20 - 7.82702590157653e-21i,-4.15723576514765e-20 - 2.70816828423800e-20i,3.10351485438854e-17 + 3.43155776850564e-17i,-6.04363525025910e-20 + 2.35902083580452e-20i,2.34729783405611e-20 + 6.81921705594458e-20i,5.98848197015125e-20 + 1.26928941551763e-19i,3.86849251986421e-20 + 5.97246732900842e-20i,3.96772996316450e-20 - 2.22403065367358e-19i,-1.99896181218331e-20 - 9.67089669891407e-21i,-1.20659369409449e-19 + 8.39227244012902e-20i,9.83507335218065e-20 - 3.28136447418840e-20i,1.60310068662056e-20 - 5.46789379649033e-20i,-7.92277537648876e-20 - 2.79706638788871e-20i,-4.79808926798907e-19 - 9.14414062460812e-20i,5.30066937604068e-20 + 7.15574194516301e-20i,-3.24139590910936e-19 + 6.80153705594053e-19i,-7.69354581876512e-20 + 2.06601439826873e-20i,-6.48381005669084e-20 + 2.58380000682614e-20i,-7.93927997149234e-20 + 2.22175354002729e-20i,5.07236540866396e-20 - 3.42848376262567e-22i,8.11561246700826e-20 + 5.72550780656273e-20i,6.07996835596843e-20 - 1.03443535235368e-20i,-1.26550948097635e-19 + 5.73837844513006e-20i,-5.57706952371163e-20 - 2.75586958656758e-20i,-2.98602062174540e-20 + 5.01246027362444e-20i,-1.22109489574866e-20 + 1.18893208843480e-19i,4.59002037661274e-20 + 1.15013335923715e-19i,1.36159775687300e-20 - 1.55553452035576e-20i,-9.81409506345865e-20 - 7.25388253900436e-20i,-1.04984736259224e-19 + 5.63341207755101e-20i,7.29511968453096e-20 + 6.94385575588419e-21i,-6.60496513398507e-20 - 7.18032169893925e-20i,7.25162180060281e-21 + 7.16085009458516e-20i,-2.78287927339753e-20 - 6.18643394852773e-20i,1.60063668169693e-19 + 3.66184019409652e-20i,-5.43780990621908e-20 - 1.39091140638694e-19i,-1.22643351472670e-20 + 1.26027121558013e-23i,-3.24952065420644e-20 - 3.16739537942677e-19i,6.87299765947516e-20 + 7.31082866189306e-20i,-6.52377036185754e-20 - 8.30626910958898e-20i,-3.82447951334645e-20 - 2.15987881263724e-20i,1.07762128267929e-20 + 6.96151564822503e-20i,5.09063390616081e-20 - 8.59909314605811e-21i,-5.16123200012661e-21 - 2.03722642614811e-20i,1.87510732003428e-20 + 4.43015021005263e-21i,-1.05044297334393e-20 - 6.94692555265121e-20i,-1.59699213164208e-20 + 4.68858357620740e-20i,3.87213886277493e-20 + 2.49187337862412e-20i,8.16257404119111e-20 - 3.59329907470712e-21i,-5.17439862793044e-20 + 6.60718431937254e-20i,1.19297223599768e-17 - 3.01100975283464e-17i,-3.11614493053745e-20 - 2.58360210923083e-20i,6.41763226864247e-20 + 9.57810160281279e-20i,-5.87513068889712e-20 - 1.09725406486443e-19i,-3.39162700199826e-20 - 3.06116818358550e-20i,5.87461785858051e-20 - 1.02492229522054e-19i,3.87532327523776e-20 + 2.81571270370176e-20i,-4.78417670251374e-20 - 5.52471264931393e-20i,9.02935502880575e-20 + 5.03371555448131e-20i,2.50857527180754e-20 - 4.43125868311131e-20i,-8.06829796697456e-20 + 1.96619665550951e-20i,3.95324773597478e-20 - 8.76565323033991e-20i,-1.29856239908259e-20 + 7.85316918712265e-21i,3.11337869428215e-15 - 3.26983040081208e-15i,-1.24058361695694e-20 - 1.45368103451758e-20i,-4.86086744759008e-21 - 2.87587383728275e-20i,-6.14426135820912e-20 + 9.42310217600194e-20i,-2.16645739986846e-20 + 9.43176279493578e-20i,9.06168878577665e-20 + 3.75068274292658e-20i,7.43414571717186e-20 - 8.73226859039390e-20i,-3.94123075704502e-20 - 6.06924372954463e-20i,3.00095357810236e-21 + 9.32036203793209e-20i,-9.58406687090431e-21 - 6.55771282067557e-20i,7.50429853904537e-21 - 6.67866768365447e-20i,-1.70190250164534e-20 + 9.54937002221767e-20i,6.60919732073036e-20 + 1.27492313998436e-20i,4.05811109908537e-13 + 4.41005344468096e-14i,3.07356668326624e-20 - 3.60631450526839e-20i,2.00126226388011e-20 - 1.25987923755024e-19i,2.17514747981375e-19 - 8.47656546323562e-21i,4.67152130226388e-20 - 2.48074951482793e-20i,7.21160599071821e-20 + 2.37997292238676e-20i,1.33703087677388e-20 - 1.66517282722780e-20i,-5.72240528531544e-20 - 1.41136008162454e-19i,-7.54559887104587e-20 - 1.32911694691123e-19i,-2.02726520896006e-20 + 2.37119961841158e-21i,-5.66682355085791e-20 - 4.02459878842406e-20i,-4.70655608129798e-20 - 3.53167006021268e-20i,-6.23223776928686e-20 - 6.54413644327669e-20i,3.25849741019213e-11 + 1.05830383485461e-11i,-1.23631526366435e-20 + 8.42053344572542e-20i,-4.97836261670646e-20 + 1.56565995007311e-20i,-8.73246668221633e-20 + 1.77605570136544e-20i,2.10475468224538e-20 + 1.20889654279091e-20i,-1.19611167393685e-21 - 5.37444922948296e-20i,-5.13119007227338e-20 - 2.47166658276450e-20i,1.91543288728531e-20 + 2.43715955880082e-20i,-3.69645349599976e-20 - 6.07773536429912e-20i,-2.19204261613854e-19 - 1.11014215717832e-19i,-1.22539070791879e-20 + 1.96479347554977e-21i,3.08716286815962e-20 - 5.88018881937699e-20i,1.55764507082038e-19 + 1.81948044912807e-20i,2.71362242335240e-09 + 2.44119632880310e-09i,-7.42257659203198e-20 - 7.89210881913128e-20i,-4.97115166248193e-20 + 1.07072373267859e-20i,5.07599251534650e-20 - 1.62729522172663e-20i,-2.94506005348655e-20 + 2.20890664224736e-20i,-6.77485705113363e-20 - 2.55678437978521e-20i,-1.05160655725469e-19 + 8.37425761481682e-20i,-2.26683866900441e-20 - 1.16351817215386e-19i,-3.38044107712200e-20 + 1.14554357134829e-19i,3.01937021664406e-20 + 1.22272750395193e-20i,2.22936006309987e-20 - 7.11958181738261e-20i,-3.60592955085116e-20 - 2.52320463055309e-20i,-2.34687605097764e-20 - 4.35421472965981e-20i,-5.08044450526543e-08 + 1.55254346219090e-07i,4.30059750729199e-21 - 9.52329919802366e-20i,-3.36846262446936e-20 - 7.24911300274149e-20i,-4.68654595590345e-20 + 2.69877688586518e-20i,-2.15909647993349e-20 + 1.01022703909689e-19i,9.06916083917052e-21 - 1.61978552340639e-20i,-1.83506266029197e-20 - 1.39022827782006e-19i,-1.96621160413505e-19 + 3.27354056507237e-20i,-3.56391495606835e-20 + 4.55741066648927e-20i,-1.75486230650743e-20 - 2.89878287162601e-20i,7.41822998684542e-20 - 6.45407470221341e-20i,-8.29516173882542e-20 - 4.14635005800998e-20i,-1.04995138717181e-19 - 3.84798652950116e-20i,3.60188035249442e-06 + 2.09318430363414e-05i,1.19655953439535e-20 + 1.20945186911622e-21i,-1.58394464905534e-20 + 9.42981210834602e-20i,1.49464617210500e-20 - 2.50605572707413e-20i,-3.68503180489140e-20 - 1.21975645071121e-19i,-9.30109567416804e-20 - 5.04895628176302e-20i,-1.52407633826490e-19 - 1.02396898789860e-19i,-1.56330839542664e-19 + 1.06879383132714e-19i,2.60908348064233e-20 - 1.41502386827047e-19i,2.70791677872418e-20 + 3.40083539093478e-20i,5.15352814182566e-20 + 6.35294118688085e-20i,-8.07756391570676e-21 + 7.88206821974316e-20i,4.85633088492178e-20 + 1.74829417369879e-20i,-0.000217544413268104 + 0.000227651838677627i,6.32027121570971e-20 - 1.71935681303083e-20i,-1.45987087259667e-19 - 1.79333946976469e-20i,3.69411832866035e-20 - 8.13010247089416e-20i,-4.33937462373696e-20 - 4.74608616690125e-20i,4.79675421589041e-20 - 1.18912088535653e-19i,-5.88201212855199e-20 + 1.85229330522180e-20i,-6.87668975508430e-20 + 1.29008316269961e-19i,-3.99004246193768e-20 - 1.52510901303496e-20i,-6.95620551872458e-21 - 1.46890516598960e-20i,1.03826755188569e-20 - 2.20020458648777e-20i,-8.90474531859358e-20 - 3.31034038927251e-20i,7.07136339090152e-20 + 7.50311543808091e-21i]*Res.Temp.Space.N;
    Res.Temp.In.t_start                 = 49.9;
    Res.Temp.Met      = [];

    tic
    Res.Temp.Sol      = Chi23_Runge_Kuarong_mex(Res.Temp,Runge);
    toc
%%
    Res.Stat.In           = Res.CW.In;
    Res.Stat.Par          = Res.CW.Par;
    
    Res.Stat.In.N         = 2^8;
    Res.Stat.Met.Newton   = @Newton_Manual_bicgstab;%'fsolve'
    
    Res.Stat              = Res.Stat.Met.Norm(Res.Stat);
    
    Res.Stat.Sol.Psi_o    = 1E-10*ones(1,Res.Stat.Space.N);
    Res.Stat.Sol.Psi_e    = 1E-10*ones(1,Res.Stat.Space.N);
    
%    Res.Stat.Sol.Psi_o(1) = Res.Temp.Sol.Psio(end-1,1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(2) = Res.Temp.Sol.Psio(end-1,1+13)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(3) = Res.Temp.Sol.Psio(end-1,1+13*2)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(4) = Res.Temp.Sol.Psio(end-1,1+13*3)*Res.Stat.Space.N;
%     
%     Res.Stat.Sol.Psi_e(1) = Res.Temp.Sol.Psie(end-1,1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(2) = Res.Temp.Sol.Psie(end-1,1+13)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(3) = Res.Temp.Sol.Psie(end-1,1+13*2)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(4) = Res.Temp.Sol.Psie(end-1,1+13*3)*Res.Stat.Space.N;
%         
%     Res.Stat.Sol.Psi_o(end) = Res.Temp.Sol.Psio(end-1,end-13+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(end-1) = Res.Temp.Sol.Psio(end-1,end-13*2+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(end-2) = Res.Temp.Sol.Psio(end-1,end-13*3+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_o(end-3) = Res.Temp.Sol.Psio(end-1,end-13*4+1)*Res.Stat.Space.N;
%     
%     Res.Stat.Sol.Psi_e(end) = Res.Temp.Sol.Psie(end-1,end-13+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(end-1) = Res.Temp.Sol.Psie(end-1,end-13*2+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(end-2) = Res.Temp.Sol.Psie(end-1,end-13*3+1)*Res.Stat.Space.N;
%     Res.Stat.Sol.Psi_e(end-3) = Res.Temp.Sol.Psie(end-1,end-13*4+1)*Res.Stat.Space.N;
    Res.Stat.Sol.Psi_o = Res.Temp.Sol.Psio(end-1,:)*Res.Stat.Space.N;
    Res.Stat.Sol.Psi_e = Res.Temp.Sol.Psie(end-1,:)*Res.Stat.Space.N;

    Slv_Start             = [real(Res.Stat.Sol.Psi_o),imag(Res.Stat.Sol.Psi_o)...
                    ,real(Res.Stat.Sol.Psi_e),imag(Res.Stat.Sol.Psi_e),0.];
                
    [Slv,eps_f,Exitflag] = Newton_Switcher(Slv_Start,Res.Stat);
    
    Res.Stat.Sol.Psi_o   = (Slv(1:Res.Stat.Space.N) + 1i*Slv(Res.Stat.Space.N+1:2*Res.Stat.Space.N))/Res.Stat.Space.N;
    Res.Stat.Sol.Psi_e   = (Slv(2*Res.Stat.Space.N+1:3*Res.Stat.Space.N) + 1i*Slv(3*Res.Stat.Space.N+1:4*Res.Stat.Space.N))/Res.Stat.Space.N;
    Res.Stat.Sol.V       =  Slv(end);
    
%   Res.Stat.Stab          = Stability_Switcher(Res.Stat);
    
%%

function Temp = Chi23_Temp_Start_CW(Temp,CW)

    Temp.In.Psi_Start                 = 1E-3*ones(1,Temp.Space.N*2);
    Temp.In.Psi_Start(1)              = (CW.Sol.Psi_o)*Temp.Space.N;
    Temp.In.Psi_Start(Temp.Space.N+1) = (CW.Sol.Psi_e)*Temp.Space.N;
    Temp.In.t_start                   = 0;
    
end
function Res = Get_to_point(Res,W,delta)    
    
    NN = 1000;
    delta_vector          = linspace(delta(1),delta(2),NN);
    W_vector              = linspace(W(1),W(2),NN);
    
    Res.CW.In.W           = W(1)*Res.CW.In.W_Star;        
    Res.CW.In.delta       = delta(1)*Res.CW.In.ko;        
    
    Res.CW                = Res.CW.Met.Solve_Chi2(Res.CW ); 

    [~,ind]               = min(abs(Res.CW.Sol.Omega));

    Res.CW.Sol.Omega      =  Res.CW.Sol.Omega(ind);    
    Res.CW.Sol.Psi_o      =  Res.CW.Sol.Psi_o(ind);    
    Res.CW.Sol.Psi_e      =  Res.CW.Sol.Psi_e(ind);

        for i_d = 1:NN

            Res.CW.In.delta_o    = delta_vector(i_d)*Res.CW.In.ko;            
            Res.CW.In.W          = W_vector(i_d)*Res.CW.In.W_Star;            
            Res.CW               = Res.CW.Met.Norm(Res.CW);  
            [Slv,eps_f,Exitflag] = Newton_Switcher([real(Res.CW.Sol.Psi_o(1)),imag(Res.CW.Sol.Psi_o(1)),real(Res.CW.Sol.Psi_e(1)),imag(Res.CW.Sol.Psi_e(1))],Res.CW);
            Res.CW               = Res.CW.Met.Prop_Gen(Slv,Res.CW);          
            
            if eps_f > 1E-5
                
                break;
                
            end        
        end
        
    end
 